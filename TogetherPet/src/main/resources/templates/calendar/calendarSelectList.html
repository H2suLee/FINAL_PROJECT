<!DOCTYPE html>
<html xmlns:th="https://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layout/layout}">

<head>
	<meta charset="UTF-8">
	<link href='fullcalendar/main.css' rel='stylesheet' />
	<script src='fullcalendar/main.js'></script>
	<script src='fullcalendar/locales/ko.js'></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
	<title>My page</title>
	<style>
		#calendarModal {
			position: fixed;
			top: 30%;
			left: 10%;
		}
	</style>

</head>

<body>
	<article layout:fragment="content">

		<script>
			document.addEventListener('DOMContentLoaded', function () {
				var calendarEl = document.getElementById('calendar');

				var calendar = new FullCalendar.Calendar(calendarEl, {
					initialView: 'dayGridMonth', // 홈페이지에서 다른 형태의 view를 확인할 수 있음
					events: [{ // this object will be "parsed" into an Event Object
						title: 'TEST', // 제목
						start: '2022-09-01', // 시작일자
						end: '2022-09-05' // 종료일자
					}],
					headerToolbar: {
						left: 'prev,next today',
						center: 'title',
						// right: 'dayGridMonth,timeGridWeek,timeGridDay'
						right: 'addEventButton'
					},
					customButtons: {
						addEventButton: { // 추가한 버튼 설정
							text: "일정 추가", // 버튼 내용
							click: function () { // 버튼 클릭 시 이벤트 추가
								$("#calendarModal").modal("show"); // modal 나타내기

								$("#addCalendar").on("click", function () { // modal의 추가 버튼 클릭 시
									var content = $("#content").val();
									var start_date = $("#startDt").val();
									var end_date = $("#endDt").val();

									// 내용 입력 여부 확인
									if (content == null || content == "") {
										alert("내용을 입력하세요.");
									} else if (start_date == "" || end_date == "") {
										alert("날짜를 입력하세요.");
									} else if (new Date(end_date) - new Date(start_date) <
										0) { // date 타입으로 변경 후 확인
										alert("종료일이 시작일보다 먼저입니다.");
									} else { // 정상적인 입력 시
										var obj = {
											"title": content,
											"start": start_date,
											"end": end_date
										} // 전송할 객체 생성

										console.log(obj); // 서버로 해당 객체를 전달해서 DB 연동 가능
									}
								});
							}
						}
					},
					// navLinks: true, // can click day/week names to navigate views
					// selectable: true,
					// selectMirror: true,
					// dateClick: function (info) {
					// 	alert('clicked ' + info.dateStr);
					// },
					// select: function (info) {
					// 	alert('selected ' + info.startStr + ' to ' + info.endStr);
					// },
					locale: 'ko',
					editable: true, // false로 변경 시 draggable 작동 x 
					displayEventTime: false // 시간 표시 x
				});

				calendar.render();
			});
		</script>
		<!--shop  area start-->
		<br> <br> <br>
		<div class="shop_section shop_reverse">
			<div class="container">
				<div class="row">
					<div class="col-lg-3 col-md-12">
						<!--sidebar widget start-->
						<aside class="sidebar_widget">
							<div class="widget_inner">
								<div class="widget_list widget_categories">
									<ul>
										<li class="widget_sub_categories"><a href="javascript:void(0)"
												data-toggle="collapse" data-target="#men">내 정보</a></li>
										<hr>
										<li class="widget_sub_categories"><a href="javascript:void(0)"
												data-toggle="collapse" data-target="#women">내 반려동물 정보</a></li>
										<hr>
										<li class="widget_sub_categories"><a data-toggle="collapse"
												data-target="#footwear">내 활동</a>
											<ul class="widget_dropdown_categories collapse show" id="footwear">
												<li><a href="#">작성 글 보기</a></li>
												<li><a href="#">작성 댓글 보기</a></li>
											</ul>
										</li>
										<hr>
										<li class="widget_sub_categories"><a data-toggle="collapse"
												data-target="#accessories">내 스크랩</a>
											<ul class="widget_dropdown_categories collapse show" id="accessories">
												<li><a href="#">병원</a></li>
												<li><a href="#">장례</a></li>
												<li><a href="#">숙박</a></li>
												<li><a href="#">커뮤니티</a></li>
											</ul>
										</li>
										<hr>
										<li class="widget_sub_categories"><a data-toggle="collapse"
												data-target="#footwear">내 쇼핑</a>
											<ul class="widget_dropdown_categories collapse show" id="footwear">
												<li><a href="#">주문내역</a></li>
												<li><a href="#">교환 및 반품</a></li>
											</ul>
										</li>
										<hr>
										<li class="widget_sub_categories"><a data-toggle="collapse"
												data-target="#footwear">내 클래스</a>
											<ul class="widget_dropdown_categories collapse show" id="footwear">
												<li><a href="#">수강내역</a></li>
												<li><a href="#">위시리스트</a></li>
											</ul>
										</li>
										<hr>
										<li class="widget_sub_categories"><a href="calendarSelectList"
												data-toggle="collapse" data-target="#women">일정관리</a></li>
									</ul>
								</div>
							</div>
						</aside>
						<!--sidebar widget end-->
					</div>


					<div class="col-lg-9 col-md-12">
						<!--shop wrapper start-->
						<!-- Content wrapper -->
						<div class="content-wrapper">
							<!-- Content -->
							<div class="container-xxl flex-grow-1 container-p-y">
								<!--breadcrumbs area start-->
								<div class="breadcrumb_content">
									<ul>
										<li><a href="/">home</a></li>
										<li>my calendar</li>
									</ul>
								</div>
								<!--breadcrumbs area end-->

								<!-- 캘린더 시작 -->
								<div id='calendar'></div>
								<!-- 캘린더 종료 -->


								<!-- modal 추가 -->
								<div class="modal fade" id="calendarModal" tabindex="-1" role="dialog"
									aria-labelledby="exampleModalLabel" aria-hidden="true">
									<div class="modal-dialog" role="document">
										<div class="modal-content">
											<div class="modal-header">
												<h5 class="modal-title" id="exampleModalLabel">일정을 입력하세요.</h5>
												<button type="button" class="close" data-dismiss="modal"
													aria-label="Close">
													<span aria-hidden="true">&times;</span>
												</button>
											</div>
											<div class="modal-body">
												<div class="form-group">
													<label for="taskId" class="col-form-label">일정 내용</label>
													<input type="text" class="form-control" id="content" name="content">
													<label for="taskId" class="col-form-label">시작 날짜</label>
													<input type="date" class="form-control" id="startDt" name="startDt">
													<label for="taskId" class="col-form-label">종료 날짜</label>
													<input type="date" class="form-control" id="endDt" name="endDt">
												</div>
											</div>
											<div class="modal-footer">
												<button type="button" class="btn btn-warning"
													id="addCalendar">일정추가</button>
												<button type="button" class="btn btn-secondary" data-dismiss="modal"
													id="sprintSettingModalClose">취소</button>
											</div>

										</div>
									</div>
								</div>


								<div class="content-backdrop fade"></div>
							</div>
							<!-- Content wrapper -->


							<!--shop wrapper end-->
						</div>
					</div>
				</div>
			</div>
			<!--shop  area end-->
		</div>
	</article>
</body>

</html>